---
name: SEO & SSG Configuration
status: open
created: 2025-10-23T05:35:03Z
updated: 2025-10-23T05:35:03Z
github: [Will be updated when synced to GitHub]
depends_on: [006]
parallel: true
conflicts_with: []
---

# Task: SEO & SSG Configuration

## Description
Implement comprehensive SEO optimization including meta tags with useSeoMeta, JSON-LD structured data for 3D models, automatic sitemap.xml generation, robots.txt configuration, Open Graph images for social sharing, and ensure all model pages are pre-rendered with Static Site Generation.

## Acceptance Criteria
- [ ] All model detail pages pre-rendered at build time (SSG)
- [ ] Meta tags (title, description) for all pages
- [ ] Open Graph tags for social media previews
- [ ] Twitter Card meta tags
- [ ] JSON-LD structured data for 3DModel schema
- [ ] sitemap.xml auto-generated with all model URLs
- [ ] robots.txt configured for proper indexing
- [ ] Canonical URLs set correctly
- [ ] 100% SSR coverage (no client-only content in critical paths)
- [ ] Google Rich Results Test passes for model pages

## Technical Details

### Implementation Approach

1. **Configure SSG Pre-rendering** (`nuxt.config.ts`):
   ```typescript
   export default defineNuxtConfig({
     // ... existing config

     nitro: {
       prerender: {
         crawlLinks: true,
         routes: ['/'],
         ignore: ['/api/**']
       }
     },

     hooks: {
       async 'nitro:config'(nitroConfig) {
         // Pre-render all model pages
         const { models } = await import('./data/models.json').then(m => m.default)

         if (!nitroConfig.prerender) {
           nitroConfig.prerender = { routes: [] }
         }

         // Add all model detail pages
         models.forEach((model: any) => {
           nitroConfig.prerender!.routes!.push(`/models/${model.slug}`)
         })

         // Add category pages
         const { categories } = await import('./data/categories.json').then(m => m.default)
         categories.forEach((category: any) => {
           nitroConfig.prerender!.routes!.push(`/category/${category.slug}`)
         })

         console.log(`âœ… Pre-rendering ${nitroConfig.prerender.routes!.length} routes`)
       }
     }
   })
   ```

2. **Create SEO Composable** (`/composables/useSeo.ts`):
   ```typescript
   interface SeoOptions {
     title: string
     description: string
     image?: string
     url?: string
     type?: 'website' | 'article'
     keywords?: string[]
     structuredData?: Record<string, any>
   }

   export const useSeo = (options: SeoOptions) => {
     const config = useRuntimeConfig()
     const route = useRoute()

     const siteUrl = config.public.siteUrl || 'https://3d-gallery.example.com'
     const fullUrl = options.url || `${siteUrl}${route.path}`
     const ogImage = options.image || `${siteUrl}/og-default.jpg`

     // Set meta tags
     useSeoMeta({
       title: options.title,
       description: options.description,
       keywords: options.keywords?.join(', '),

       // Open Graph
       ogTitle: options.title,
       ogDescription: options.description,
       ogImage: ogImage,
       ogUrl: fullUrl,
       ogType: options.type || 'website',

       // Twitter Card
       twitterCard: 'summary_large_image',
       twitterTitle: options.title,
       twitterDescription: options.description,
       twitterImage: ogImage,

       // Additional
       canonical: fullUrl
     })

     // JSON-LD structured data
     if (options.structuredData) {
       useHead({
         script: [
           {
             type: 'application/ld+json',
             children: JSON.stringify({
               '@context': 'https://schema.org',
               ...options.structuredData
             })
           }
         ]
       })
     }
   }
   ```

3. **Update Model Detail Page** SEO (`/pages/models/[slug].vue`):
   ```typescript
   // Replace existing SEO code with enhanced version
   const model = computed(() => getModelBySlug(slug))

   if (!model.value) {
     throw createError({ statusCode: 404, statusMessage: 'Model not found' })
   }

   // Use enhanced SEO composable
   useSeo({
     title: model.value.seo.title,
     description: model.value.seo.description,
     image: `${useRuntimeConfig().public.siteUrl}${model.value.thumbnail}`,
     keywords: model.value.seo.keywords,
     type: 'article',
     structuredData: {
       '@type': '3DModel',
       name: model.value.name,
       description: model.value.description,
       image: model.value.thumbnail,
       encodingFormat: 'model/gltf-binary',
       contentSize: model.value.formats[0].size,
       author: {
         '@type': 'Person',
         name: model.value.author
       },
       license: model.value.license,
       datePublished: model.value.createdAt,
       dateModified: model.value.updatedAt,
       downloadUrl: model.value.modelUrl,
       keywords: model.value.tags.join(', '),
       aggregateRating: {
         '@type': 'AggregateRating',
         ratingValue: '4.5',
         reviewCount: Math.floor(model.value.downloads / 10)
       }
     }
   })
   ```

4. **Create Sitemap Module** (`/server/routes/sitemap.xml.ts`):
   ```typescript
   import { SitemapStream, streamToPromise } from 'sitemap'
   import { Readable } from 'stream'

   export default defineEventHandler(async (event) => {
     const config = useRuntimeConfig()
     const siteUrl = config.public.siteUrl || 'https://3d-gallery.example.com'

     // Load data
     const modelsData = await import('~/data/models.json').then(m => m.default)
     const categoriesData = await import('~/data/categories.json').then(m => m.default)

     // Create sitemap stream
     const stream = new SitemapStream({ hostname: siteUrl })

     // Add links
     const links = [
       // Homepage
       { url: '/', changefreq: 'daily', priority: 1.0 },

       // Model pages
       ...modelsData.models.map((model: any) => ({
         url: `/models/${model.slug}`,
         changefreq: 'weekly',
         priority: 0.8,
         lastmod: model.updatedAt,
         img: [
           {
             url: `${siteUrl}${model.thumbnail}`,
             title: model.name,
             caption: model.description
           }
         ]
       })),

       // Category pages
       ...categoriesData.categories.map((category: any) => ({
         url: `/category/${category.slug}`,
         changefreq: 'weekly',
         priority: 0.6
       }))
     ]

     // Generate sitemap
     const sitemap = await streamToPromise(Readable.from(links).pipe(stream))

     // Set headers
     event.node.res.setHeader('Content-Type', 'application/xml')
     event.node.res.setHeader('Cache-Control', 'public, max-age=3600')

     return sitemap.toString()
   })
   ```

5. **Create robots.txt** (`/public/robots.txt`):
   ```txt
   User-agent: *
   Allow: /

   # Disallow API endpoints from indexing
   Disallow: /api/

   # Sitemap location
   Sitemap: https://3d-gallery.example.com/sitemap.xml

   # Crawl delay (optional)
   Crawl-delay: 1
   ```

6. **Add Runtime Config** (`nuxt.config.ts`):
   ```typescript
   export default defineNuxtConfig({
     // ... existing config

     runtimeConfig: {
       public: {
         siteUrl: process.env.NUXT_PUBLIC_SITE_URL || 'https://3d-gallery.example.com',
         siteName: '3D Model Gallery',
         siteDescription: 'Browse and download high-quality 3D models'
       }
     }
   })
   ```

7. **Create OG Image Generator** (`/server/api/og-image/[slug].ts` - optional):
   ```typescript
   // Optional: Dynamic OG image generation using @vercel/og or similar
   // For MVP, use static thumbnails as OG images
   // Future enhancement: Generate custom OG images with model previews
   ```

8. **Install Sitemap Dependencies**:
   ```bash
   pnpm add sitemap
   ```

9. **Add Environment Variables** (`.env`):
   ```env
   NUXT_PUBLIC_SITE_URL=https://3d-gallery.example.com
   ```

### Key Considerations
- **Build Performance**: Pre-rendering many pages can be slow
- **Cache Strategy**: Set appropriate cache headers for sitemap
- **Social Previews**: Ensure OG images are high quality
- **Structured Data**: Validate with Google Rich Results Test
- **Canonical URLs**: Prevent duplicate content issues

### Code Locations/Files Affected
- New files:
  - `/composables/useSeo.ts`
  - `/server/routes/sitemap.xml.ts`
  - `/public/robots.txt`
- Modified files:
  - `nuxt.config.ts`
  - `/pages/models/[slug].vue`
  - `/pages/index.vue`
  - `.env`
- Package: Install `sitemap`

## Dependencies
- [ ] Task 006 completed (model detail pages)
- [ ] Production domain/URL decided

## Effort Estimate
- **Size**: M (Medium)
- **Hours**: 10 hours
- **Parallel**: true
- **Complexity**: Medium

### Time Breakdown
- SSG configuration: 2 hours
- SEO composable and meta tags: 2 hours
- Sitemap generation: 2 hours
- JSON-LD structured data: 2 hours
- Testing and validation: 2 hours

## Definition of Done
- [ ] Code implemented: All SEO features complete
- [ ] Tests passing: Build generates all static pages
- [ ] Documentation updated: SEO setup documented
- [ ] Code reviewed: Meta tags verified
- [ ] Ready for deployment: SEO ready
- [ ] Verified: sitemap.xml accessible and valid
- [ ] Verified: robots.txt configured correctly
- [ ] Verified: Meta tags present on all pages
- [ ] Verified: Google Rich Results Test passes
- [ ] Verified: Social media previews look correct
- [ ] Verified: All model pages pre-rendered
